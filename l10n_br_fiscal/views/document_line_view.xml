<?xml version="1.0" encoding="utf-8"?>
<odoo>

  <record id="document_line_form" model="ir.ui.view">
    <field name="name">l10n_br_fiscal.document.line.form</field>
    <field name="model">l10n_br_fiscal.document.line</field>
    <field name="arch" type="xml">
      <form string="Fiscal Document Line">
        <field name="currency_id" invisible="1"/>
        <field name="operation_type" invisible="1"/>
        <field name="company_id" invisible="1"/>
        <field name="partner_id" invisible="1"/>
        <group>
          <field name="product_id" context="{'form_view_ref': 'product.product_template_form_view'}"/>
          <field name="name" required="1"/>
        </group>
        <group>
          <group name="commercial_infors" string="Commercial">
            <label for="quantity"/>
            <div class="o_row">
              <field name="quantity" class="oe_inline"/>
              <field name="uom_id" groups="uom.group_uom" class="oe_inline"/>
            </div>
            <field name="price"/>
          </group>
          <group name="fiscal_infors" string="Fiscal">
            <label for="fiscal_quantity"/>
            <div class="o_row">
              <field name="fiscal_quantity" class="oe_inline"/>
              <field name="uot_id" groups="uom.group_uom" class="oe_inline"/>
            </div>
            <field name="fiscal_price"/>
            <field name="ncm_id"/>
            <field name="cest_id"/>
            <field name="nbs_id"/>
          </group>
          <group id="l10n_br_fiscal" name="operation" string="Operation">
          </group>
        </group>
        <group name="taxes" string="Taxes">
          <notebook>
            <page name="icms" string="ICMS">
                <group>
                    <field name="icms_tax_id"/>
                    <field name="icms_cst_id"/>
                    <field name="icmssn_tax_id"/>
                    <field name="icmssn_cst_id"/>
                </group>
                <group>
                    <group>
                      <field name="icms_base"/>
                      <field name="icms_percent"/>
                    </group>
                    <group>
                      <field name="icms_reduction"/>
                      <field name="icms_value"/>
                    </group>
                </group>
            </page>
            <page name="ipi" string="IPI">
                <group string="IPI">
                    <field name="ipi_tax_id"/>
                    <field name="ipi_cst_id" attrs="{'readonly': [('ipi_tax_id', '=', False)]}"/>
                    <field name="ipi_guideline_id"/>
                </group>
                <group>
                    <group>
                      <field name="ipi_base_type" attrs="{'readonly': [('ipi_tax_id', '=', True)]}"/>
                      <field name="ipi_percent" attrs="{'readonly': [('ipi_tax_id', '=', True)]}"/>
                      <field name="ipi_reduction" attrs="{'readonly': [('ipi_tax_id', '=', True)]}"/>
                    </group>
                    <group>
                      <field name="ipi_base" attrs="{'readonly': [('ipi_tax_id', '=', True)]}"/>
                      <field name="ipi_value" attrs="{'readonly': [('ipi_tax_id', '=', True)]}"/>
                    </group>
                </group>
            </page>
            <page name="pis" string="PIS">
                <group name="pis" string="PIS">
                  <field name="pis_tax_id"/>
                  <field name="pis_cst_id" force_save="1" attrs="{'readonly': [('pis_tax_id', '!=', False)]}"/>
                  <field name="pis_credit_id" force_save="1" attrs="{'readonly': [('pis_tax_id', '!=', False)], 'invisible': [('operation_type', '=', 'out')]}"/>
                </group>
                <group>
                  <group>
                    <field name="pis_base_id" force_save="1" attrs="{'readonly': [('pis_tax_id', '!=', False)], 'invisible': [('operation_type', '=', 'out')]}"/>
                    <field name="pis_base_type" force_save="1" attrs="{'readonly': [('pis_tax_id', '!=', False)]}"/>
                    <field name="pis_percent" force_save="1" attrs="{'readonly': [('pis_tax_id', '!=', False)]}"/>
                    <field name="pis_reduction" force_save="1" attrs="{'readonly': [('pis_tax_id', '!=', False)]}"/>
                  </group>
                  <group>
                    <field name="pis_base" force_save="1" attrs="{'readonly': [('pis_tax_id', '!=', False)]}"/>
                    <field name="pis_value" force_save="1" attrs="{'readonly': [('pis_tax_id', '!=', False)]}"/>
                  </group>
                </group>
                <group name="pis_st" string="PIS ST">
                  <field name="pisst_tax_id"/>
                  <field name="pisst_cst_id" force_save="1" attrs="{'readonly': [('pisst_tax_id', '!=', False)]}"/>
                </group>
                <group>
                  <group>
                    <field name="pisst_base_type" force_save="1" attrs="{'readonly': [('pisst_tax_id', '!=', False)]}"/>
                    <field name="pisst_percent" force_save="1" attrs="{'readonly': [('pisst_tax_id', '!=', False)]}"/>
                    <field name="pisst_reduction" force_save="1" attrs="{'readonly': [('pisst_tax_id', '!=', False)]}"/>
                  </group>
                  <group>
                    <field name="pisst_base" force_save="1" attrs="{'readonly': [('pisst_tax_id', '!=', False)]}"/>
                    <field name="pisst_value" force_save="1" attrs="{'readonly': [('pisst_tax_id', '!=', False)]}"/>
                  </group>
                </group>
            </page>
            <page name="cofins" string="COFINS">
              <group name="cofins" string="COFINS">
                <field name="cofins_tax_id"/>
                <field name="cofins_cst_id" force_save="1" attrs="{'readonly': [('cofins_tax_id', '!=', False)]}"/>
                <field name="cofins_credit_id" force_save="1" attrs="{'readonly': [('cofins_tax_id', '!=', False)], 'invisible': [('operation_type', '=', 'out')]}"/>
              </group>
              <group>
                <group>
                  <field name="cofins_base_id" force_save="1" attrs="{'readonly': [('cofins_tax_id', '!=', False)], 'invisible': [('operation_type', '=', 'out')]}"/>
                  <field name="cofins_base_type" force_save="1" attrs="{'readonly': [('cofins_tax_id', '!=', False)]}"/>
                  <field name="cofins_percent" force_save="1" attrs="{'readonly': [('cofins_tax_id', '!=', False)]}"/>
                  <field name="cofins_reduction" force_save="1" attrs="{'readonly': [('cofins_tax_id', '!=', False)]}"/>
                </group>
                <group>
                  <field name="cofins_base" force_save="1" attrs="{'readonly': [('cofins_tax_id', '!=', False)]}"/>
                  <field name="cofins_value" force_save="1" attrs="{'readonly': [('cofins_tax_id', '!=', False)]}"/>
                </group>
              </group>
              <group name="cofins_st" string="COFINS ST">
                <field name="cofinsst_tax_id"/>
                <field name="cofinsst_cst_id" force_save="1" attrs="{'readonly': [('cofinsst_tax_id', '!=', False)]}"/>
              </group>
              <group>
                <group>
                  <field name="cofinsst_base_type" force_save="1" attrs="{'readonly': [('cofinsst_tax_id', '!=', False)]}"/>
                  <field name="cofinsst_percent" force_save="1" attrs="{'readonly': [('cofinsst_tax_id', '!=', False)]}"/>
                  <field name="cofinsst_reduction" force_save="1" attrs="{'readonly': [('cofinsst_tax_id', '!=', False)]}"/>
                </group>
                <group>
                  <field name="cofinsst_base" force_save="1" attrs="{'readonly': [('cofinsst_tax_id', '!=', False)]}"/>
                  <field name="cofinsst_value" force_save="1" attrs="{'readonly': [('cofinsst_tax_id', '!=', False)]}"/>
                </group>
              </group>
            </page>
          </notebook>
        </group>
      </form>
    </field>
  </record>

</odoo>
